machine:
  environment:
    GO_PROJECT: ../go/src/github.com/gliderlabs/$CIRCLE_PROJECT_REPONAME
  services:
    - docker

dependencies:
  pre:
    - docker run --rm -it -v $PWD:/go/src/github.com/gliderlabs/logspout -w /go/src/github.com/gliderlabs/logspout treeder/glide install
    - make circleci
  override:
    - glide --version
    - glide install:
        pwd: $GO_PROJECT
    - make build
  post:
    - cp build/* $CIRCLE_ARTIFACTS

test:
  override:
    - /bin/true

deployment:
  release:
    branch: release
    commands:
      - make release
